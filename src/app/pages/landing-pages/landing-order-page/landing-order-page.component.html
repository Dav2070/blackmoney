<div class="container slide-up-in">
	<!-- Grid Container: Produkte und Warenkorb -->
	<div class="products-cart-container">
		<!-- Produkte-Bereich -->
		<div class="products-section">
			<!-- Kategorien-Bar -->
			<div class="categories-bar">
				<dav-tab-bar>
					@for (category of menu?.categories; track category.uuid) {
						<dav-tab-bar-item
							[active]="selectedCategory?.uuid === category.uuid"
							(click)="selectCategory(category)"
						>
							{{ category.name }}
						</dav-tab-bar-item>
					}
				</dav-tab-bar>
			</div>
			@for (category of menu?.categories; track category.uuid) {
				@if (category.products.length > 0) {
					<div class="category-section" [id]="'category-' + category.uuid">
						<h2 class="category-title">{{ category.name }}</h2>
						<div class="product-items">
							@for (product of category.products; track product.uuid) {
								<div
									class="product-card slide-up-in-light"
									(click)="addToCart(product)"
								>
									<div class="product-card-id">
										<p>#{{ product.shortcut }}</p>
									</div>

									<div class="product-card-name">
										<p>{{ product.name }}</p>
									</div>

									<div class="product-card-price">
										<p>{{ formatPrice(product.price) }}</p>
									</div>

									<div class="product-card-add">
										<dav-icon-button
											size="xs"
											(click)="$event.stopPropagation()"
										>
											<fa-icon [icon]="faPlus"></fa-icon>
										</dav-icon-button>
									</div>
								</div>
							}
						</div>
					</div>
				}
			}
		</div>

		<!-- Warenkorb -->
		<div class="cart-section">
			<div class="cart-header">
				<h3>Warenkorb</h3>
			</div>

			<div class="cart-items-container">
				@if (cartItems.length === 0) {
					<p class="cart-empty-message">Ihr Warenkorb ist leer</p>
				} @else {
					<ul class="cart-items-list">
						@for (item of cartItems; track item.uuid) {
							<li class="cart-item">
								<div class="cart-item-info">
									<span class="cart-item-name">{{
										item.product.name
									}}</span>
									<span class="cart-item-price">
										{{ formatPrice(item.product.price * item.count) }}
									</span>
								</div>
								<div class="cart-item-controls">
									<dav-icon-button
										size="xs"
										(click)="decreaseQuantity(item)"
									>
										<fa-icon [icon]="faMinus"></fa-icon>
									</dav-icon-button>

									<span class="cart-item-count">{{ item.count }}</span>

									<dav-icon-button
										size="xs"
										(click)="increaseQuantity(item)"
									>
										<fa-icon [icon]="faPlus"></fa-icon>
									</dav-icon-button>

									<dav-icon-button
										size="xs"
										(click)="removeFromCart(item)"
									>
										<fa-icon [icon]="faTrash"></fa-icon>
									</dav-icon-button>
								</div>
							</li>
						}
					</ul>
				}
			</div>

			<div class="cart-footer">
				<div class="cart-total">
					<span class="cart-total-label">Gesamt:</span>
					<span class="cart-total-price">
						{{ formatPrice(getCartTotal()) }}
					</span>
				</div>

				<dav-button
					color="primary"
					[disabled]="cartItems.length === 0"
					(click)="submitOrder()"
				>
					Bestellen
				</dav-button>
			</div>
		</div>
	</div>
</div>
