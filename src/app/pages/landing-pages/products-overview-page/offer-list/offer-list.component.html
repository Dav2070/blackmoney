<div class="offers-list">
	<ng-container *ngIf="offers?.length > 0; else emptyState">
		<ng-container *ngFor="let offer of offers; trackBy: trackByUuid">
			<dav-card class="offer-card">
				<div class="offer-header">
					<div class="header-content">
						<h3>{{ offer.name }}</h3>
						<span class="offer-id">ID: {{ offer.id }}</span>
					</div>
					<div class="offer-actions">
						<dav-icon-button
							size="xs"
							[tooltip]="locale.options"
							(click)="showOfferContextMenu($event, offer)"
						>
							<fa-icon [icon]="faEllipsis"></fa-icon>
						</dav-icon-button>
					</div>
				</div>

				<div class="separator"></div>

				<div class="offer-content">
					<div class="offer-meta">
						<span class="price">{{ offer.price | currency: "EUR" }}</span>
						<ng-container *ngIf="offer.takeaway">
							<span class="badge takeaway">Takeaway</span>
						</ng-container>
					</div>

					<div class="offer-weekdays">
					{{ formatAvailability(offer.offer) }}
				</div>

					<!-- Offer Items -->
					<div class="offer-items">
						<ng-container
							*ngIf="offer.offer?.offerItems?.length > 0; else noItems"
						>
							<ng-container
								*ngFor="let item of offer.offer.offerItems; trackBy: trackByUuid"
							>
								<div class="offer-item">
									<div class="item-header">
										<h4>{{ item.name }}</h4>
										<span class="max-selections"
											>(max. {{ item.maxSelections }} ausw√§hlbar)</span
										>
									</div>

									<div class="item-products">
										<ng-container
											*ngFor="let product of item.products; trackBy: trackByUuid"
										>
											<div class="product-chip">
												{{ product.name }}
											</div>
										</ng-container>
									</div>
								</div>
							</ng-container>
						</ng-container>

						<ng-template #noItems>
							<p class="no-items">{{ locale.noItems }}</p>
						</ng-template>
					</div>
				</div>
			</dav-card>
		</ng-container>
	</ng-container>

	<ng-template #emptyState>
		<p class="no-offers">{{ locale.noOffers }}</p>
	</ng-template>
</div>

<!-- Offer Context Menu -->
<dav-context-menu
	#offerContextMenu
	[visible]="contextMenuVisible"
	[posX]="contextMenuX"
	[posY]="contextMenuY"
>
	<dav-context-menu-item [value]="actionsLocale.edit" (click)="editSelectedOffer()">
		<fa-icon slot="icon" [icon]="faPen"></fa-icon>
	</dav-context-menu-item>

	<dav-context-menu-item [value]="actionsLocale.delete" (click)="deleteSelectedOffer()">
		<fa-icon slot="icon" [icon]="faTrash"></fa-icon>
	</dav-context-menu-item>
</dav-context-menu>
